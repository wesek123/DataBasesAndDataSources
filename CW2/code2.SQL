/*1.*/
SELECT CONCAT(CONCAT(FIRST_NAME, ' '), SALARY) AS wynagrodzenie 
FROM EMPLOYEES 
WHERE DEPARTMENT_ID IN (20,50) AND SALARY BETWEEN 2000 AND 7000 
ORDER BY wynagrodzenie;

/*2.*/
SELECT LAST_NAME, HIRE_DATE, &USER_INPUT as USER_OUTPUT
FROM EMPLOYEES
WHERE MANAGER_ID IS NOT NULL AND HIRE_DATE BETWEEN TO_DATE('2005/01/01', 'yyyy/mm/dd') AND 
TO_DATE('2005/12/31', 'yyyy/mm/dd')
ORDER BY USER_OUTPUT;

/*3.*/
SELECT CONCAT(CONCAT(LAST_NAME, ' '), FIRST_NAME) AS EMPLOYEE, SALARY, PHONE_NUMBER 
FROM EMPLOYEES
WHERE LAST_NAME LIKE '__e' AND FIRST_NAME LIKE '%' || '&USER_INPUT' || '%' 
ORDER BY 1 DESC, 2 ASC;

/*4.*/
SELECT FIRST_NAME, LAST_NAME, 
MONTHS_BETWEEN(END_DATE, START_DATE) AS MONTHS_WORKED,
CASE WHEN MONTHS_BETWEEN(END_DATE, START_DATE) < 150 THEN 0.1 * SALARY
WHEN MONTHS_BETWEEN(END_DATE, START_DATE) BETWEEN 150 AND 200 THEN 0.2 * SALARY
WHEN MONTHS_BETWEEN(END_DATE, START_DATE) > 200 THEN 0.3 * SALARY END AS ALLOWENCE
FROM JOB_HISTORY, EMPLOYEES
ORDER BY MONTHS_WORKED;

/*5.*/
SELECT DEPARTMENT_ID, SUM(SALARY) AS SUM, AVG(SALARY) AS AVG
FROM EMPLOYEES, JOBS
WHERE MIN_SALARY >= 5000
GROUP BY DEPARTMENT_ID;

/*6.*/
SELECT e.LAST_NAME, e.DEPARTMENT_ID, d.DEPARTMENT_NAME, d.LOCATION_ID, e.JOB_ID, l.CITY 
FROM EMPLOYEES e 
LEFT JOIN DEPARTMENTS d ON (e.DEPARTMENT_ID=d.DEPARTMENT_ID) 
LEFT JOIN LOCATIONS l ON (d.LOCATION_ID = l.LOCATION_ID) 
WHERE CITY = 'Toronto';

/*7.*/
SELECT FIRST_NAME, LAST_NAME
FROM EMPLOYEES
WHERE DEPARTMENT_ID IN (SELECT DEPARTMENT_ID
FROM EMPLOYEES WHERE FIRST_NAME = 'Jennifer');

/*8.*/
SELECT DEPARTMENT_NAME 
FROM DEPARTMENTS MINUS 
SELECT distinct DEPARTMENT_NAME 
FROM DEPARTMENTS 
RIGHT JOIN EMPLOYEES E ON E.DEPARTMENT_ID = DEPARTMENTS.DEPARTMENT_ID;

/*9.*/
CREATE TABLE JOB_GRADES 
AS (SELECT * FROM HR.JOB_GRADES);

/*10.*/
SELECT e.FIRST_NAME, e.LAST_NAME, e.JOB_ID, d.DEPARTMENT_NAME, e.SALARY, 
(SELECT GRADE FROM JOB_GRADES 
WHERE MIN_SALARY <= e.SALARY AND MAX_SALARY >= e.SALARY) AS GRADE 
FROM EMPLOYEES e 
LEFT JOIN DEPARTMENTS d ON (e.DEPARTMENT_ID = d.DEPARTMENT_ID);

/*11.*/
SELECT FIRST_NAME, LAST_NAME, SALARY
FROM EMPLOYEES
WHERE SALARY > (SELECT AVG(SALARY) FROM EMPLOYEES)
ORDER BY SALARY DESC;

/*12.*/
SELECT e.FIRST_NAME, e.LAST_NAME
FROM  EMPLOYEES e
WHERE e.DEPARTMENT_ID IN  (SELECT e2.DEPARTMENT_ID FROM EMPLOYEES e2 WHERE e2.LAST_NAME LIKE '%u%');

